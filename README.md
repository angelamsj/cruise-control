# Cruise control using Elma

This project consists on extending the cruise control Elma application. This extended version will include a more sofisticated model of the dynamics of the car and a PID controller. To evaluate the performance of the system, data aquired from simulations will be plotted. This project builds upon the [Elma library](https://github.com/klavinslab/elma.git).

## Resources

- Elma library
- GNU plot
- C++ libraries 
- Docker
- [Cruise control model](http://www.cds.caltech.edu/~murray/amwiki/index.php/Cruise_control)

## Milestones

1. 03/12 - Define dynamics of new model.
2. 03/13 - Implement new model.
3. 03/16 - Implement PID controller. 
4. 03/19 - Get the GNU plot working.
5. 03/22 - Test anf finish project.

## Model Dynamics

The motion of a car can be described with the following model:

     *m dv/dt = F - Fd*

     *a = dv/dt = (F - Fd) / m*

  - v: velocity.
  - m: total mass of the car and passengers. 
  - F: force generated by the contact of the wheels with the road (force generated by engine). 
  - Fd: sum of disturbance forces.
  - a: aceleration

### Force generated by engine

The velocity of the car is related to the speed of the engine through the following expresion:

    *w = (n / r) v = alpha_n v*
    
  - w: engine speed.     
  - n: gear ratio.     
  - r: wheel radius.     
  - alpha_n: gear ratio over wheel radio (typical values 40, 25, 16, 12, 10 for alpha 1, 2, 3, 4, 5 respectively).     

- **Force generated by the engine at full throttle.**

    *T(w) = Tm (1 - beta ((w / wm) - 1) ^ 2)*
 
  - T(w): engine torque. 
  - Tm: maximum torque (typical value 190 Nm).
  - wm: engine speed at maximum torque (typical value 240 rad/s).
  - beta: typical value of 0.4.

    - **Control signal**

The throttle is proportional to de control signal (u), which has the following restrictions:

    *0 <= u <= 1*
    
- **Force generated by engine**
  
    *F = u (n / r) T(w) = u alpha_n T(alpha_n v)*
    
### Disturbance forces 

    *Fd = Fg + Fr + Fa*
    
  - Fg: force due to gravity.
  - Fr: force due to rolling friction. 
  - Fa: force due to aerodynamic drag.  

- **Force due to gravity**

    *Fg = m g sin(theta)* 
  
  - theta: slope of the road.
  - g: gravitational constant (9.8 m/s^2).

- **Force due to rolling friction**

    *Fr = m g Cr sgn(v)*
    
  - Cr: coefficient of rolling friction (typical value 0.01).
  - sgn(v): zero if velocity is zero, sign of the velocity otherwise.

- **Force due to aerodynamic drag**

    *Fa = 0.5 rho Cd A v^2*
    
  - rho: density of the air (typical value 1.3 kg/m^3).
  - Cd: shape-dependent aerodynamic drag coefficient (typical value 0.32).
  - A: frontal area of the car (~ 2.4 m^2).

  


### License
---

This software is open source and uses the MIT license. 
